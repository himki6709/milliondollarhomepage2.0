<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>12 YEARS LEGACY | THE LITTLE HOUSE</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <style>
        :root { --gold: #9E7E45; --white: #ffffff; --black: #000; }
        body { margin: 0; background: #000; color: #fff; font-family: 'Times New Roman', serif; overflow-x: hidden; }

        /* Navigation */
        .top-nav { position: fixed; top: 0; width: 100%; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; background: rgba(0,0,0,0.95); border-bottom: 1px solid #222; box-sizing: border-box; }
        .logo { font-size: 18px; letter-spacing: 3px; font-weight: bold; text-transform: uppercase; }
        .logo span { font-size: 11px; color: var(--gold); display: block; }
        
        .nav-right { display: flex; gap: 10px; }
        .nav-btn { background: none; border: 1px solid #444; color: #fff; padding: 10px 15px; font-size: 10px; letter-spacing: 2px; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .buy-btn { background: var(--gold) !important; color: #000 !important; font-weight: bold; border: none; }

        /* Header Area */
        .header-area { text-align: center; padding-top: 120px; margin-bottom: 40px; }
        .main-title { 
            font-size: clamp(30px, 8vw, 60px); letter-spacing: 5px; font-weight: 900;
            background: linear-gradient(90deg, #FFD700, #FF0055, #D400FF, #00C3FF, #00FFCC);
            background-size: 300% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: colorShift 8s linear infinite; text-transform: uppercase;
        }
        @keyframes colorShift { to { background-position: 300% center; } }

        /* Grid Container */
        .canvas-wrapper { 
            width: 95%; max-width: 1300px; margin: 0 auto; 
            background: #050505; border: 1px solid #222; 
            padding: 10px; overflow: auto; height: 70vh;
            display: grid;
            grid-template-columns: repeat(60, 20px); /* ৬০ কলাম */
            gap: 1px; /* ১ পিক্সেল গ্যাপ */
            justify-content: center;
        }

        /* Pixel/Plot Styles */
        .plot {
            width: 20px;
            height: 20px;
            background: #111;
            cursor: pointer;
            position: relative;
            transition: 0.2s;
        }
        .plot:hover { transform: scale(1.3); z-index: 10; border: 1px solid #fff; }

        /* Tooltip */
        .tooltip {
            position: fixed; background: #fff; color: #000; padding: 8px 12px;
            font-size: 11px; pointer-events: none; display: none; z-index: 5000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); border-radius: 2px;
        }

        /* Modal */
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.98); display:none; align-items:center; justify-content:center; z-index:9999; }
        .card { background: #fff; color:#000; padding:40px; width:90%; max-width:400px; text-align:center; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; }
        .color-preview { height: 40px; width: 100%; border: 1px solid #000; margin: 10px 0; }
    </style>
</head>
<body>

    <div class="top-nav">
        <div class="logo">12 YEARS LEGACY <span>KAWSAR <small>TM</small></span></div>
        <div class="nav-right">
            <button class="nav-btn" onclick="location.href='dashboard.html'">TRACK</button>
            <button class="nav-btn buy-btn" onclick="openModal()">RESERVE PLOT</button>
        </div>
    </div>

    <div class="header-area">
        <h1 class="main-title">4,380 Days of History</h1>
        <p style="color: var(--gold); letter-spacing: 3px; font-size: 12px;">DESCENDING PRICE SYSTEM: $4380 TO $1</p>
    </div>

    <div class="canvas-wrapper" id="gridContainer">
        </div>

    <div class="tooltip" id="plotTooltip"></div>

    <div id="buy-modal" class="modal">
        <div class="card">
            <h2 style="font-size: 16px; letter-spacing: 2px;">ACQUIRE PLOT</h2>
            <p id="selectedPlotInfo" style="font-size: 12px; color: #666;"></p>
            <input type="text" id="brandName" placeholder="BRAND NAME">
            <label style="font-size: 10px; display: block; text-align: left;">PICK YOUR RGB SHADE:</label>
            <input type="color" id="plotColor" value="#9E7E45" onchange="updatePreview(this.value)">
            <div class="color-preview" id="cp"></div>
            <button class="nav-btn buy-btn" style="width:100%; margin-top:10px;" onclick="submitRequest()">SEND REQUEST</button>
            <button class="nav-btn" style="width:100%; margin-top:5px; color:#000;" onclick="closeModal()">CANCEL</button>
        </div>
    </div>

    <script>
        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyDJbVCF0AkLkCiCwFBc1Ki5PrKxFeYt8_E",
            authDomain: "milliondollarhomepage2-71ba3.firebaseapp.com",
            databaseURL: "https://milliondollarhomepage2-71ba3-default-rtdb.firebaseio.com",
            projectId: "milliondollarhomepage2-71ba3",
            storageBucket: "milliondollarhomepage2-71ba3.firebasestorage.app",
            messagingSenderId: "895107568682",
            appId: "1:895107568682:web:d48003f71701005f3d5f53"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const totalPlots = 4380;
        const grid = document.getElementById('gridContainer');
        const tooltip = document.getElementById('plotTooltip');
        let currentSelectedID = null;

        // Generate Plots
        for (let i = 1; i <= totalPlots; i++) {
            const plot = document.createElement('div');
            plot.className = 'plot';
            plot.id = 'plot-' + i;
            const price = totalPlots - (i - 1);
            
            plot.onmouseover = (e) => {
                tooltip.style.display = 'block';
                tooltip.innerHTML = `<strong>Plot #${i}</strong><br>Price: $${price}<br>Status: Vacant`;
                tooltip.style.left = (e.clientX + 15) + 'px';
                tooltip.style.top = (e.clientY + 15) + 'px';
            };
            plot.onmouseout = () => tooltip.style.display = 'none';
            plot.onclick = () => openModal(i, price);
            
            grid.appendChild(plot);
        }

        function openModal(id, price) {
            if(!id) return;
            currentSelectedID = id;
            document.getElementById('buy-modal').style.display = 'flex';
            document.getElementById('selectedPlotInfo').innerText = `Plot #${id} | Current Price: $${price}`;
            updatePreview("#9E7E45");
        }

        function closeModal() { document.getElementById('buy-modal').style.display = 'none'; }
        function updatePreview(c) { document.getElementById('cp').style.background = c; }

        function submitRequest() {
            const name = document.getElementById('brandName').value;
            const color = document.getElementById('plotColor').value;
            if(!name) return alert("Enter Brand Name");

            db.ref('orders/' + currentSelectedID).set({
                plotID: currentSelectedID,
                name: name,
                color: color,
                status: 'pending'
            }).then(() => {
                confetti({ particleCount: 100, spread: 70 });
                alert("Order Sent! Contact Support with Plot ID #" + currentSelectedID);
                closeModal();
            });
        }

        // Live Load Data
        db.ref('pixels').on('value', snap => {
            const data = snap.val();
            if(!data) return;
            Object.values(data).forEach(p => {
                const el = document.getElementById('plot-' + p.plotID);
                if(el) {
                    el.style.background = p.color;
                    el.onmouseover = (e) => {
                        tooltip.style.display = 'block';
                        tooltip.innerHTML = `<strong>${p.name}</strong><br>Plot #${p.plotID}<br>Owned Heritage`;
                        tooltip.style.left = (e.clientX + 15) + 'px';
                        tooltip.style.top = (e.clientY + 15) + 'px';
                    };
                }
            });
        });
    </script>
</body>
</html>
